#Breaker Selection
#æœ¬ç¨‹åºçš„è¿è¡Œéœ€è¦Python3åŠä»¥ä¸Šç‰ˆæœ¬
#æœ¬ç¨‹åºå› éœ€æ±‚åªåŒ…å«220KVä¾§ã€110KVä¾§ä»¥åŠ10KVä¾§çš„éƒ¨åˆ†æ–­è·¯å™¨

import time
#220KVæ–­è·¯å™¨åˆ—è¡¨
Breakers_220KV = [
	["LW1-220/2000", 220, 2000, 31.5, 80, 31.5, 4, "SF6", "æˆ·å¤–"],
	["LW1-220/2000", 220, 2000, 40, 100, 40, 4, "SF6", "æˆ·å¤–"],
	["LW1-220/3150", 220, 3150, 31.5, 80, 31.5, 4, "SF6", "æˆ·å¤–"],
	["LW1-220/2500", 220, 3150, 40, 100, 40, 4, "SF6", "æˆ·å¤–"],
	["LW2-220/2500", 220, 2500, 31.5, 80, 31.5, 4, "SF6", "æˆ·å¤–"],
	["LW2-220/2500", 220, 2500, 40, 100, 40, 4, "SF6", "æˆ·å¤–"],
	["LW2-220/2500", 220, 2500, 50, 125, 50, 4, "SF6", "æˆ·å¤–"],
	["LW6-220/3150", 220, 3150, 40, 100, 40, 3, "SF6", "æˆ·å¤–"],
	["LW6-220/3150", 220, 3150, 50, 125, 50, 3, "SF6", "æˆ·å¤–"],
	["SFM220-220/2000", 220, 2000, 40, 80, 40, 3, "SF6", "æˆ·å¤–"],
	["SFM220-220/2500", 220, 2500, 50, 80, 50, 3, "SF6", "æˆ·å¤–"],
	["SFM220-220/3150", 220, 3150, 50, 100, 50, 3, "SF6", "æˆ·å¤–"],
	["SFM220-220/4000", 220, 2000, 63, 80, 63, 3, "SF6", "æˆ·å¤–"],
	["SFMT220-220/2000", 220, 2000, 31.5, 80, 31.5, 3, "SF6", "æˆ·å¤–"],
	["SFMT220-220/2500", 220, 2500, 40, 100, 40, 3, "SF6", "æˆ·å¤–"],
	["SFMT220-220/3150", 220, 3150, 50, 125, 50, 3, "SF6", "æˆ·å¤–"],
	["SW2-220", 220, 1000, 18.4, 55, 21, 4, "å°‘æ²¹", "æˆ·å¤–"],
	["SW4-220", 220, 1000, 18.4, 55, 21, 5, "å°‘æ²¹", "æˆ·å¤–"],
	["SW6-220", 220, 1200, 21, 55, 21, 4, "å°‘æ²¹", "æˆ·å¤–"],
	["SW7-220", 220, 1500, 21, 55, 21, 4, "å°‘æ²¹", "æˆ·å¤–"]
]

#110KVæ–­è·¯å™¨åˆ—è¡¨
Breakers_110KV = [
	["LW-110I/2500", 110, 2500, 31.5, 125, 50, 3, "SF6", "æˆ·å¤–"],
	["LW6-110II/3150", 110, 3150, 40, 125, 50, 3, "SF6", "æˆ·å¤–"],
	["SFM110-110/2000", 110, 2000, 31.5, 80, 31.5, 3, "SF6", "æˆ·å¤–"],
	["SFM110-110/2500", 110, 2500, 40, 100, 40, 3, "SF6", "æˆ·å¤–"],
	["SFM110-110/3150", 110, 3150, 50, 125, 50, 3, "SF6", "æˆ·å¤–"],
	["SFM110-110/4000", 110, 4000, 50, 125, 50, 3, "SF6", "æˆ·å¤–"],
	["SFMT110-110/2000", 110, 2000, 40, 80, 31.5, 3, "SF6", "æˆ·å¤–"],
	["SFMT110-110/2500", 110, 2000, 50, 100, 40, 3, "SF6", "æˆ·å¤–"],
	["SFMT110-110/3150", 110, 3150, 63, 125, 50, 3, "SF6", "æˆ·å¤–"],
	["SW3-110", 110, 1200, 18.4, 41, 15.8, 4, "å°‘æ²¹", "æˆ·å¤–"],
	["SW4-110", 110, 1000, 18.4, 55, 21, 5, "å°‘æ²¹", "æˆ·å¤–"],
	["SW4-110G", 1000, 15.8, 55, 21, 5, "å°‘æ²¹", "æˆ·å¤–"],
	["SW6-110", 1200, 21, 55, 15.8, 4, "å°‘æ²¹", "æˆ·å¤–"],
	["SW7-110", 1200, 15.8, 55, 21, 4, "å°‘æ²¹", "æˆ·å¤–"]
]

#10KVæ–­è·¯å™¨åˆ—è¡¨
Breakers_10KV = [
	["ZN4-10/1000", 10, 1000, 17.3, 44, 17.3, 4, "çœŸç©º", "æˆ·å†…"],
	["ZN12-10/1250", 10, 1250, 31.5, 80, 31.5, 3, "çœŸç©º", "æˆ·å†…"],
	["ZN12-10/1600", 10, 1600, 31.5, 80, 31.5, 3, "çœŸç©º", "æˆ·å†…"],
	["ZN12-10/2000", 10, 2000, 40, 100, 40, 3, "çœŸç©º", "æˆ·å†…"],
	["ZN12-10/2500", 10, 2500, 31.5, 80, 31.5, 3, "çœŸç©º", "æˆ·å†…"],
	["ZN12-10/3150", 10, 3150, 55, 125, 50, 3, "çœŸç©º", "æˆ·å†…"],
	["SN3-10/600", 10, 600, 11.6, 52, 20, 4, "å°‘æ²¹", "æˆ·å†…"],
	["SN3-10/1000", 10, 1000, 23, 65, 23, 4, "å°‘æ²¹", "æˆ·å†…"],
	["SN10-10/600", 10, 600, 28.9, 52, 20.2, 4, "å°‘æ²¹", "æˆ·å†…"],
	["SN10-10/1000", 10, 1000, 28.9, 71, 29, 4, "å°‘æ²¹", "æˆ·å†…"],
	["SN10-10/12500", 10, 12500, 28.9, 71, 29, 4, "å°‘æ²¹", "æˆ·å†…"],
	["SN10-10/3000", 10, 3000, 28.9, 130, 13.2, 4, "å°‘æ²¹", "æˆ·å†…"],
	["SN3-10/2000", 10, 2000, 29, 75, 30, 5, "å°‘æ²¹", "æˆ·å†…"],
	["SN3-10/3000", 10, 3000, 29, 75, 30, 5, "å°‘æ²¹", "æˆ·å†…"],
	["SN4-10G/5000", 10, 5000, 105, 300, 120, 5, "å°‘æ²¹", "æˆ·å†…"],
	["SN4-10G/6000", 10, 6000, 105, 300, 120, 5, "å°‘æ²¹", "æˆ·å†…"],
	["SN5-20G/6000", 10, 6000, 87, 300, 120, 5, "å°‘æ²¹", "æˆ·å†…"],
	["SN5-20G/8000", 10, 8000, 87, 300, 120, 5, "å°‘æ²¹", "æˆ·å†…"],
	["SN5-20G/12000", 10, 12000, 87, 300, 120, 5, "å°‘æ²¹", "æˆ·å†…"],
]

#è®¡ç®—Qkçš„å‡½æ•°
def caculate_Qk(It, t):
	return It**2*t
	
#é€‰æ‹©å‹å·å‡½æ•°
def Select_Breaker(UN, Imax, I0s, Qk, Ish, _type, _location):
	equipments = []
		
	if UN == 220:
		if _type == 1:
			for i in range(0,16):
				if (Breakers_220KV[i][2] >= Imax and Breakers_220KV[i][3] >= I0s and \
				caculate_Qk(Breakers_220KV[i][5], Breakers_220KV[i][6]) >= Qk and \
				Breakers_220KV[i][4] >= Ish):
					equipments.append(Breakers_220KV[i])
		if _type == 2:
			for i in range(16,20):
				if (Breakers_220KV[i][2] >= Imax and Breakers_220KV[i][3] >= I0s and \
				caculate_Qk(Breakers_220KV[i][5], Breakers_220KV[i][6]) >= Qk and \
				Breakers_220KV[i][4] >= Ish):
					equipments.append(Breakers_220KV[i])
					
	if UN == 110:
		if _type == 1:
			for i in range(0,9):
				if (Breakers_110KV[i][2] >= Imax and Breakers_110KV[i][3] >= I0s and \
				caculate_Qk(Breakers_110KV[i][5], Breakers_110KV[i][6]) >= Qk and \
				Breakers_110KV[i][4] >= Ish):
					equipments.append(Breakers_110KV[i])
		if _type == 2:
			for i in range(9,14):
				if (Breakers_110KV[i][2] >= Imax and Breakers_110KV[i][3] >= I0s and \
				caculate_Qk(Breakers_110KV[i][5], Breakers_110KV[i][6]) >= Qk and \
				Breakers_110KV[i][4] >= Ish):
					equipments.append(Breakers_110KV[i])
				
	if UN == 10:
		if _type == 2:
			for i in range(6,19):
				if (Breakers_10KV[i][2] >= Imax and Breakers_10KV[i][3] >= I0s and \
				caculate_Qk(Breakers_10KV[i][5], Breakers_10KV[i][6]) >= Qk and \
				Breakers_10KV[i][4] >= Ish):
					equipments.append(Breakers_10KV[i])
		if _type == 3:
			for i in range(0,6):
				if (Breakers_10KV[i][2] >= Imax and Breakers_10KV[i][3] >= I0s and \
				caculate_Qk(Breakers_10KV[i][5], Breakers_10KV[i][6]) >= Qk and \
				Breakers_10KV[i][4] >= Ish):
					equipments.append(Breakers_10KV[i])
	
	if equipments == []:
		print("\næ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„æ–­è·¯å™¨ï¼\n")
		return
	
	#è¾“å‡ºè¡¨æ ¼
	time.sleep(0.1)
	print("\næ­£åœ¨ç­›é€‰...\n")
	time.sleep(0.3)
	title = "ç¬¦åˆæ¡ä»¶çš„æ–­è·¯å™¨æ¸…å•"
	name = "æ–­è·¯å™¨åç§°"
	_UN = "UN(KV)"
	_Imax = "IN(A)"
	_INbr = "INbr(KA)"
	_ies = "ies(KA)"
	_Iq = "Iq(KA)"
	_t = "t(s)"
	_type = "æ–­è·¯å™¨ç±»å‹"
	_location = "ä½¿ç”¨åœºåˆ"
	print("{:^125}\n".format(title))
	print("{:^20}{:12}{:11}{:13}{:^20}{:^14}{:^11}{:^6}{:^8}\n"\
	.format(name, _UN, _Imax, _INbr, _ies, _Iq, _t, _type, _location))
	for i in range(0, len(equipments)):
		print("{:^20}{:^12}{:^11}{:^16}{:^20}{:^14}{:^11}{:^10}{:^8}\n"\
		.format(equipments[i][0], equipments[i][1], equipments[i][2], \
		equipments[i][3], equipments[i][4], equipments[i][5], \
		equipments[i][6], equipments[i][7], equipments[i][8]))
	
#ä¸»å‡½æ•°
if __name__ == '__main__':
	while True:
		s = 'è¯·è¾“å…¥ä»¥ä¸‹æ•°æ®ç”¨äºæ–­è·¯å™¨çš„é€‰å‹'
		print("{:*^25}".format(s)+'\n')
		try:
			UN = int(input("è¯·è¾“å…¥é¢å®šç”µå‹ UN(KV)ï¼š"))
			while UN != 220 and UN != 110 and UN != 10:
				print("âš ï¸æœ¬ç¨‹åºä»…æ”¯æŒUNä¸º220KVï¼Œ110KVï¼Œ10KVä¸‰ä¸ªç”µå‹ç­‰çº§\n")
				input_UN_again_text = "è¯·é‡æ–°è¾“å…¥"
				print("{:*^25}".format(input_UN_again_text)+'\n')
				UN = int(input("è¯·è¾“å…¥é¢å®šç”µå‹ UN(KV)ï¼š"))
			if UN == 220 or UN == 110:
				location = 1
				print("æç¤ºğŸ’¡:220KVä¾§ä»¥åŠ110KVä¾§ä»…å¯ä½¿ç”¨æˆ·å¤–å‹æ–­è·¯å™¨ï¼Œå·²è‡ªåŠ¨é”å®šåªç­›é€‰æˆ·å¤–å‹\n")
				_type = int(input("è¯·è¾“å…¥æ–­è·¯å™¨ç±»å‹(SF6æ–­è·¯å™¨:1 / å°‘æ²¹æ–­è·¯å™¨:2): "))
				while _type != 1 and _type != 2:
					print("âš ï¸è¾“å…¥æœ‰è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼\n")
					_type = int(input("è¯·è¾“å…¥æ–­è·¯å™¨ç±»å‹(SF6æ–­è·¯å™¨:1 / å°‘æ²¹æ–­è·¯å™¨:2): "))
			if UN == 10:
				location = 2
				print("æç¤ºğŸ’¡:10KVä¾§ä»…å¯ä½¿ç”¨æˆ·å†…å‹æ–­è·¯å™¨ï¼Œå·²è‡ªåŠ¨é”å®šåªç­›é€‰æˆ·å†…å‹\n")
				_type = int(input("è¯·è¾“å…¥æ–­è·¯å™¨ç±»å‹(å°‘æ²¹æ–­è·¯å™¨:2 / çœŸç©ºæ–­è·¯å™¨:3): "))
				while _type != 2 and _type != 3:
					print("âš ï¸è¾“å…¥æœ‰è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼\n")
					_type = int(input("è¯·è¾“å…¥æ–­è·¯å™¨ç±»å‹(å°‘æ²¹æ–­è·¯å™¨:2 / çœŸç©ºæ–­è·¯å™¨:3): "))
			Imax = float(input("è¯·è¾“å…¥æœ€å¤§ç”µæµ Imax(A)ï¼š"))
			I0s = float(input("è¯·è¾“å…¥é›¶æ—¶ç”µæµ I\'\'(KA)ï¼š"))
			Qk = float(input("è¯·è¾“å…¥çƒ­æ•ˆåº” Qkï¼š"))
			Ish = float(input("è¯·è¾“å…¥å†²å‡»ç”µæµ Ish(KA)ï¼š"))
			Select_Breaker(UN, Imax, I0s, Qk, Ish, _type, location)
			try:
				Input_Again = int(input("æ˜¯å¦ç»§ç»­è¾“å…¥(æ˜¯:1 / å¦:0)ï¼š"))
				if Input_Again == 1:
					print("\n")
					continue
				if Input_Again == 0:
					break
				else:
					print("\nâš ï¸è¾“å…¥æœ‰è¯¯ï¼Œç¨‹åºé»˜è®¤åœæ­¢\n")
					break
			except ValueError:
				print("\nâš ï¸è¾“å…¥æœ‰è¯¯ï¼Œç¨‹åºé»˜è®¤åœæ­¢\n")
				break
		except:
			print("âš ï¸è¾“å…¥æœ‰è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼\n")
			continue